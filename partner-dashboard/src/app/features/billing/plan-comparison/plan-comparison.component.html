<div class="plan-comparison">
  <h2>Subscription Plans</h2>
  
  <div class="plans-grid" *ngIf="plans$ | async as plans; else loading">
    <p-card *ngFor="let plan of plans" [styleClass]="plan.recommended ? 'plan-card recommended' : 'plan-card'">
      <ng-template pTemplate="header">
        <div class="card-header-content">
          <p-chip 
            *ngIf="plan.recommended" 
            label="Recommended" 
            styleClass="recommended-badge">
          </p-chip>
          <div class="plan-title">
            <h3>{{ plan.name }}</h3>
            <p class="plan-subtitle">{{ plan.tier }}</p>
          </div>
        </div>
      </ng-template>
      
      <ng-template pTemplate="content">
        <div class="pricing">
          <span class="price">${{ plan.price_per_month }}</span>
          <span class="period">/month</span>
        </div>
        
        <div class="quota">
          <strong>{{ plan.monthly_quota | number }}</strong> verifications/month
        </div>
        
        <div class="per-verification">
          ${{ plan.price_per_verification }} per additional verification
        </div>
        
        <p-divider></p-divider>
        
        <ul class="features">
          <li *ngFor="let feature of plan.features">
            <i class="pi pi-check-circle"></i>
            <span>{{ feature }}</span>
          </li>
        </ul>
      </ng-template>
      
      <ng-template pTemplate="footer">
        <p-button 
          label="Upgrade to {{ plan.name }}"
          severity="primary"
          [raised]="true"
          (onClick)="upgradePlan(plan)"
          [disabled]="(loading$ | async) || false"
          styleClass="w-full">
        </p-button>
      </ng-template>
    </p-card>
  </div>

  <ng-template #loading>
    <app-loading-spinner message="Loading plans..."></app-loading-spinner>
  </ng-template>
</div>

<div class="webhook-form-dialog">
  <form [formGroup]="form">
    <div class="form-field">
      <span class="p-float-label">
        <input 
          pInputText 
          id="url" 
          formControlName="url" 
          [class.ng-invalid]="form.get('url')?.invalid && form.get('url')?.touched"
          class="full-width">
        <label for="url">Webhook URL</label>
      </span>
      <small class="p-hint">The endpoint that will receive webhook notifications</small>
      <small *ngIf="form.get('url')?.invalid && form.get('url')?.touched" class="p-error">
        {{ getErrorMessage('url') }}
      </small>
    </div>

    <div class="form-field">
      <label class="field-label">Event Types</label>
      <p-listbox 
        [options]="eventTypes" 
        formControlName="events"
        optionLabel="label" 
        optionValue="value"
        [multiple]="true"
        [checkbox]="true"
        [filter]="false"
        [listStyle]="{'max-height':'250px'}"
        styleClass="full-width">
      </p-listbox>
      <small class="p-hint">Select at least one event type</small>
      <small *ngIf="form.get('events')?.invalid && form.get('events')?.touched" class="p-error">
        Please select at least one event type
      </small>
    </div>

    <div class="form-field toggle-field">
      <label for="enabled" class="toggle-label">Enable webhook</label>
      <p-inputSwitch id="enabled" formControlName="enabled"></p-inputSwitch>
    </div>

    <p-accordion>
      <p-accordionTab header="Webhook Payload Documentation">
        <div class="payload-example">
          <h4>Example Payload</h4>
          <pre><code>&#123;
  "event_type": "session.completed",
  "timestamp": "2024-01-15T10:30:00Z",
  "session_id": "sess_abc123",
  "tenant_id": "tenant_xyz789",
  "data": &#123;
    "final_trust_score": 92.5,
    "tier_1_score": 95.0,
    "tier_2_score": 90.0,
    "correlation_value": 0.89,
    "state": "complete"
  &#125;
&#125;</code></pre>
        </div>
      </p-accordionTab>
    </p-accordion>
  </form>

  <div class="dialog-actions">
    <p-button label="Cancel" [text]="true" (onClick)="onCancel()"></p-button>
    <p-button 
      [label]="isEdit ? 'Update' : 'Create'" 
      (onClick)="onSubmit()" 
      [disabled]="form.invalid">
    </p-button>
  </div>
</div>
